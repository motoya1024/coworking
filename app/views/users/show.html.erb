<% provide(:title, 'ミーティングスペース予約画面') %>

<div class="container">  
  <h1>ミーティングスペース予約画面</h1>
  
  <h5><%= @user.name %>様　予約状況一覧</h5>
  <% @login_user_reservations.each do |login_user_reservation| %>
    <table>
        <tr>
            <td><%= l(login_user_reservation.started_at, format: :index) %>〜</td>
            <td><%= l(login_user_reservation.finished_at, format: :time) %></td>
            <td><%= link_to '削除', user_reservation_url(@user,login_user_reservation), remote: true %></td>
            <div id="show_user_reservation" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true"></div>
        </tr>
    </table>
  <% end %>
  
  <h2>ミーティングスペース予約はこちら</h2>

  <p>予約日時を選択してください。</p>
  <div class="reservation_week_form">
    <%= render 'reservation_week' %>
  </div>
  
  <div class="input-group date" id="datetimepicker" data-target-input="nearest">
    <input type="hidden" class="datetimepicker-input" data-target="#datetimepicker"/>
    <div class="input-group-append" data-target="#datetimepicker" data-toggle="datetimepicker">
        <button type="submit">カレンダー</button>
    </div>
  </div>
  
  <div class="reservation_status_list">
    <div class="can_reservation"> 
      <div></div>
      <p>予約できます</p>
    </div>
    <div class="can_not_reservation">
      <div></div>
      <p>予約できません</p>
    </div>
  </div>
  <div class="reservation_week_form_table">
    <%= render 'reservation_week_tabale_th' %>
  </div>
  <div class="reservation_week_form_table_body">
    <%= render 'reservation_week_tabale_body' %>
  </div>
  
</div>
<script>

$(function(){
  $('#datetimepicker').datetimepicker({
    format: 'L'
  });
  
   $('#datetimepicker').on('change.datetimepicker', function (e) {
       var date = String(e.date).split(" ")[3]+"-"+(new Date(e.date).getMonth() + 1)+"-"+String(e.date).split(" ")[2];
         $.ajax({
                url:'/users/<%= current_user.id %>/change_show',
                type:'GET',
                data:{
                    'prev':date
                }
            });
    });
});    
    
</script>
